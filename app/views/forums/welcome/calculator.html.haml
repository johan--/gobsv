#wrapper-calculator
  %div{id: "shareButtonLabelCount", class: "social-share-inline"}
  :javascript
    $("#shareButtonLabelCount").jsSocials({
      url: "#{forums_calculator_url}",
      text: "Compara como sera tu pension en los dos sistemas #pensionsv",
      showCount: true,
      showLabel: false,
      shares: ["twitter", "facebook"]
    })

- unless @salario.nil? || @salario <= 0
  #results
    .container
      -#
        .row
          .col-sm-12
            .charts-description
              .well.graphic-legend
                %h2.chart
                  = "Lo que te descuentan mensualmente se reparte en tu ahorro y comisiones por administración que cobran las AFP, conoce las diferencias entre el sistema actual y el sistema de reparto."
      %br
      .row
        .col-md-12.col-sm-12
          %h2
            Pensión a recibir

          .canvas-holder
            .chart-title-current-system
              = t('.current_system')
            .chart-current-system
              = "#{number_to_currency(@pension_minima_con_subsidio)}"
            .chart-title-new-system
              = t('.mixed_system')
            .chart-new-system
              = "#{number_to_currency(@pension_aproximada_reforma)}"
            .chart-title-afp-proposal
              = t('.afp_system')
            .chart-afp-proposal
              = "#{number_to_currency(@pension_final_asafondos)}"
            -#
              .chart-legend-current-system
                .items
                  .color-item-gray
                    .square
                  .item-description
                    = t('.pension_current_system', pension_savings: @pension_segun_ahorros_actual.round(2), goverment_subsidy: (@pension_minima_con_subsidio-@pension_segun_ahorros_actual).round(2))
                    =# @pension_segun_ahorros_actual <= 207.6 ? "$#{@pension_segun_ahorros_actual.round(2)} de tu ahorro de pensión + subsidio del gobierno de $#{(@pension_minima_con_subsidio-@pension_segun_ahorros_actual).round(2)}" : t('.minimal_pension_subsidy')
                    =# t('.minimal_pension_subsidy')
              .chart-legend-new-system
                .items
                  .color-item-green
                    .square
                  .item-description
                    = t('.approximate_on_mixed_pensions_system')
              .chart-legend-afp-proposal
                .items
                  .color-item-red
                    .square
                  .item-description
                    = t('.approximate_on_mixed_pensions_system')
            %canvas{id: "pension"}
            :javascript
              var pensionChart = document.getElementById("pension");
              var barChartDataPension = new Chart(pensionChart, {
                type: 'bar',
                data: {
                  labels: ["Sistema actual", "Propuesta gobierno", "Propuesta AFP's"],
                  datasets: [
                    {
                      label: 'Pension a recibir',
                      data: [#{@pension_minima_con_subsidio.round(2)}, #{@pension_aproximada_reforma.round(2)}, #{@pension_aproximada_asafondos.round(2)}],
                      backgroundColor: [
                        'rgba(233,143,111,0.8)',
                        'rgba(128,185,66,0.8)',
                        'rgba(176,120,175,0.8)',
                      ],
                      borderColor: [
                        'rgba(233,143,111,1)',
                        'rgba(128,185,66,1)',
                        'rgba(176,120,175,1)',
                      ],
                      borderWidth: 1
                    },
                  ]
                },
                options: {
                  legend: {
                    display: false,
                  },
                  title: {
                    display: false,
                  },
                  layout: {
                    padding: {
                      left: 0,
                      right: 0,
                      top: 0,
                      bottom: 0
                    }
                  },
                  tooltips: {
                    mode: 'point'
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero:true
                      }
                    }]
                  }
                }
              });

          - if @pension_segun_ahorros_actual <= 207.6
            .chart-special-legend
              = t('.clarification_current_system')
        .col-md-12.col-sm-12
          %h2
            Comisión para AFP
          .canvas-holder-polar
            .chart-donut-current-system
              = number_to_currency(@comisiones_pagadas_a_afp_actual.round(2))
            .chart-donut-goverment-reform
              = number_to_currency(@comisiones_pagadas_a_afp_reforma.round(2))
            .chart-donut-afp-reform
              = number_to_currency(@comisiones_pagadas_a_afp_asafondos.round(2))

            -#
              .chart-legend-current-system
                .items
                  .color-item-gray
                    .square
                  .item-description
                    = t('.insurance_and_payments_to_afp')
              .chart-legend-new-system
                .items
                  .color-item-red
                    .square
                  .item-description
                    = t('.insurance_and_payments_to_afp_reform')
            %canvas{id: "bar-comision-afp"}
            :javascript
              var comissionChart = document.getElementById("bar-comision-afp");
              var barChartDataCommission = new Chart(comissionChart, {
                type: 'doughnut',
                data: {
                  labels: ["Sistema actual", "Propuesta gobierno", "Propuesta AFP's"],
                  datasets: [
                    {
                      label: 'Comision para AFP´s',
                      data: [#{@comisiones_pagadas_a_afp_actual.round(2)}, #{@comisiones_pagadas_a_afp_reforma.round(2)}, #{@comisiones_pagadas_a_afp_asafondos.round(2)}],
                      backgroundColor: [
                        'rgba(233,143,111,0.8)',
                        'rgba(128,185,66,0.8)',
                        'rgba(176,120,175,0.8)',
                      ],
                      borderColor: [
                        'rgba(255,255,255,1)',
                        'rgba(255,255,255,1)',
                        'rgba(255,255,255,1)',

                      ],
                      borderWidth: 2
                    },
                  ]
                },

              });


        .col-sm-12
          %h2
            Ahorro individual
          .canvas-holder
            .chart-title-current-system
              = t('.current_system')
            .chart-current-system
              = "#{number_to_currency(@valor_final_actual)}"
            .chart-title-new-system
              = t('.mixed_system')
            .chart-new-system
              = "#{number_to_currency(@valor_final_reforma)}"
            .chart-title-afp-proposal
              = t('.afp_system')
            .chart-afp-proposal
              = "#{number_to_currency(@valor_final_asafondos)}"
            %canvas{id: "my-savings"}
            :javascript
              var savingsChart = document.getElementById("my-savings");
              var barChartDataSavings = new Chart(savingsChart, {
                type: 'bar',
                data: {
                  labels: ["Sistema actual", "Propuesta gobierno", "Propuesta AFP's"],
                  datasets: [
                    {
                      label: 'Total ahorros',
                      data: [#{@valor_final_actual.round(2)}, #{@valor_final_reforma.round(2)}, #{@valor_final_asafondos.round(2)}],
                      backgroundColor: [
                        'rgba(233,143,111,0.8)',
                        'rgba(128,185,66,0.8)',
                        'rgba(176,120,175,0.8)',

                      ],
                      borderColor: [
                        'rgba(233,143,111,1)',
                        'rgba(128,185,66,1)',
                        'rgba(176,120,175,1)',
                      ],
                      borderWidth: 1
                    },
                  ]
                },
                options: {
                  legend: {
                    display: false,
                  },
                  title: {
                    display: false,
                  },
                  layout: {
                    padding: {
                      left: 0,
                      right: 0,
                      top: 0,
                      bottom: 0
                    }
                  },
                  tooltips: {
                    mode: 'point'
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero:true
                      }
                    }]
                  }
                }
              });
      -#
        .row.current-system-cons
          .col-sm-12
            %h2.analysis-title
              Tu pensión de acuerdo al sistema actual
            .data-current-system-cons
              .custom-row-data
                .normal-well
                  = t('.personal_saves_on_afp')
                .green-well
                  = number_to_currency(@pension_segun_ahorros_actual)
              .clearfix
              - if (@pension_minima_con_subsidio-@pension_segun_ahorros_actual) > 0
                .custom-row-data
                  .normal-well
                    = t('.goverment_subsidy')
                  .green-well
                    = number_to_currency(@pension_minima_con_subsidio-@pension_segun_ahorros_actual)
                .clearfix
              .custom-row-data
                .normal-well
                  = t('.approximate_lasting_years_private')
                .green-well
                  = "#{@anios_de_pension_a_recibir.to_s} <span>años</span>".html_safe
              .clearfix
              .custom-row-data
                .normal-well
                  = t('.approximate_years_goverment_assumption')
                .green-well
                  = "#{@anios_financiaria_estado.to_s} <span>años</span>".html_safe
              .clearfix

      %br
    -#
      .row
        %h2.analysis-title
          Algunos datos que debes considerar sobre la reforma
-#
  .wrapper-considerations
    .container
      .row
        .col-md-7.col-sm-6.hidden-xs
          = image_tag("forums/consideraciones.png", class: "img-responsive", title: "Consideraciones a tomar en cuenta")
        .col-md-5.col-sm-6.col-xs-12

.wrapper-form
  .container
    .row
      .col-md-7.col-sm-6.hidden-xs
        = image_tag("forums/omg.png", class: "img-responsive", title: "Calcula cuanto recibiras de pension")
      .col-md-5.col-sm-6.col-xs-12
        .calculator-container
          %h2
            = "Calcula cuánto recibirás de pensión"
          .calc-description
            = "Compará cómo será tu pensión con el sistema actual y cómo sería si se aprueba la reforma impulsada por el Gobierno."

          = form_tag forums_calculator_path, method: :get, class: "form-horizontal", id: "calculator-form" do
            .form-group
              .input-group
                .input-group-addon
                  %span.glyphicon.glyphicon-usd
                = number_field_tag :wage, "#{params[:wage].nil? ? '' : params[:wage].to_f.abs }", placeholder: t('.enter_wage'), class: 'form-control'

              .gender
                %label.radio-inline.left-0
                  Sexo:
                = label_tag 'gender', class: "radio-inline" do
                  = radio_button_tag 'gender', 'female', true, { class: 'btn btn-primary' }
                  Mujer

                = label_tag 'gender', class: "radio-inline" do
                  = radio_button_tag 'gender', 'male', false
                  Hombre
            .form-group
              = submit_tag 'Calcular', class: 'btn btn-success btn-calculate'

              %p
                = "Los resultaddos que muestra esta calculadora se obtienen de #{link_to 'supuestos', nil} técnicos, en caso de ser modificados podrían variar los resultados.".html_safe
